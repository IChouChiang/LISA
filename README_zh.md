[English](./README.md) | **简体中文**

# L.I.S.A. - 久坐提醒助手

L.I.S.A. 是一个智能姿态监控系统，旨在预防长期久坐带来的健康问题。它利用计算机视觉技术追踪用户是否在场，并通过 AI 驱动的后端提供多样化、人性化的休息提醒。

## 项目结构与逻辑

系统分为三个核心模块：

### 模块 A：眼睛 (前端与视觉)
*   **技术栈：** HTML5, JavaScript, Google MediaPipe Pose.
*   **功能：**
    *   在浏览器本地通过摄像头捕获视频（隐私优先）。
    *   检测人体姿态关键点以确认用户是否在场。
    *   **隐私模式：** 默认情况下，视频流被隐藏并替换为骨架的“科技网格”可视化效果，确保用户无需盯着自己看。
    *   **UI 控制：** 提供深色/浅色/跟随系统主题切换、计时器暂停/恢复以及时间限制选择（10秒到1小时）。

### 模块 B：大脑 (计时器与状态逻辑)
*   **逻辑：**
    *   **在场检测：** 只有当检测到用户在画面中时，计时器才会增加。
    *   **自动暂停：** 如果用户离开，计时器会自动暂停。
    *   **自动重置：** 如果用户在触发警报*后*离开（意味着他们去休息了），当他们返回时，计时器会自动重置为 0。
    *   **警报系统：**
        *   **视觉：** 状态文本变红。
        *   **通知：** 达到限制后，每 10 秒触发一次系统通知。
        *   **音频：** 浏览器每 60 秒朗读一次由 AI 生成的消息。

### 模块 C：声音 (后端与 AI)
*   **技术栈：** Go (Golang), DeepSeek API.
*   **端口：** 运行在 `localhost:8081`。
*   **功能：**
    *   充当前端与大语言模型 (LLM) 之间的桥梁。
    *   当达到久坐限制时，接收来自前端的 `POST` 请求。
    *   调用 **DeepSeek API** 生成简短、富有创意且不重复的健康警告（例如：“你的背部会感谢你伸个懒腰！”）。
    *   将文本返回给前端，由 `window.speechSynthesis` 进行语音播报。

## 开发者快速入门

为了立即运行项目进行开发：

### 1. 先决条件
*   **Go (Golang):** 已安装并添加到 PATH。
*   **Python 3.x:** (可选) 用于资源监控。
*   **Web 浏览器:** Chrome, Edge, 或 Firefox。

### 2. 一键启动
只需运行根目录下的批处理脚本：
```cmd
start_dev.bat
```
该脚本已增强，包含以下功能：
1.  **自动配置代理：** 设置 `GOPROXY` 以加速下载。
2.  **显示进度：** 实时显示编译状态。
3.  **系统托盘模式：** 构建并启动后端作为后台应用程序（请在任务栏中寻找图标）。
4.  **启动前端：** 在默认浏览器中打开界面。

### 3. 手动启动
如果你更喜欢手动运行：

**后端：**
```bash
cd backend
# 构建无控制台窗口版本
go build -ldflags -H=windowsgui -o lisa-backend.exe main.go
# 运行
./lisa-backend.exe
```
*要停止服务器，请右键单击系统托盘中的 L.I.S.A. 图标并选择“退出”。*

**前端：**
*   在浏览器中打开 `posture-demo/index.html`。

## 配置 (API Key)

后端需要 DeepSeek API 密钥来生成 AI 响应。

1.  打开 `backend/main.go`。
2.  在文件顶部找到 `API_KEY` 常量：
    ```go
    const API_KEY = "your-key-here"
    ```
3.  将其替换为你有效的 DeepSeek API 密钥。

## 隐私说明
所有视频处理均通过 MediaPipe 在你的设备上**本地**进行。没有任何视频数据会被发送到后端或云端。仅发送文本信号（“用户坐了 X 秒”）到后端以触发 AI 响应。

## 性能与资源占用

由于 L.I.S.A. 在浏览器本地运行计算机视觉，因此有一定的硬件要求：

*   **GPU 使用率：** 中等到高。MediaPipe 使用 WebGL 加速姿态检测。当标签页处于活动状态时，你可能会注意到 GPU 使用率增加（例如在集成显卡上增加 20-40%）。
*   **CPU 使用率：** 低到中等。大部分繁重的工作都卸载到了 GPU，但浏览器仍然需要管理视频流。
*   **电池：** 如果在笔记本电脑上运行，由于摄像头处于活动状态且持续进行 AI 处理，电池消耗会比正常浏览网页更快。
*   **后端：** Go 服务器非常轻量级，CPU/RAM 消耗可以忽略不计（< 20MB RAM）。

**提示：** 如果你在低功耗设备上，可以在不使用时暂停计时器或关闭标签页以节省能源。

## 资源监控

你可以使用提供的 Python 脚本监控后端的资源使用情况。

1.  **安装依赖：**
    ```bash
    pip install -r requirements.txt
    ```
2.  **运行监控：**
    ```bash
    python monitor_resources.py
    ```
    *注意：请确保后端先运行。*
